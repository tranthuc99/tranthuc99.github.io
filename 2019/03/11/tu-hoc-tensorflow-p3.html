

<!DOCTYPE html>
<html lang=" en "><head>
    <meta charset="utf-8">
    <title>Tự học Tensorflow [P3] - Dataset, Layer</title>
    <meta http-equip="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
     <meta name="description" content="Tự học Tensorflow [P3] - Dataset, Layer" />
      <meta name="keywords" content="Tự học Tensorflow [P3] - Dataset, Layer, Nguyễn Trần Thức, Tensorflow" />
      <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml">
      <meta content="" property="fb:app_id">
      <meta content="Nguyễn Trần Thức" property="og:site_name">
      
      
        <meta content="Tự học Tensorflow [P3] - Dataset, Layer" property="og:title">
        <meta content="article" property="og:type">
      

      
        <meta content="Personal site of Thuc" property="og:description">
      

      
        <meta content="https://tranthuc99.github.io/2019/03/11/tu-hoc-tensorflow-p3" property="og:url">
      

      
        <meta content="2019-03-11T03:56:20+00:00" property="article:published_time">
        <meta content="https://tranthuc99.github.io/about/" property="article:author">
      

      

      
        
          <meta content="Tensorflow" property="article:section">
        
      

      
        
          <meta content="Self Learning Tensorflow" property="article:tag">
        
      

      <meta name="twitter:card" content="summary">
      <meta name="twitter:site" content="@">
      <meta name="twitter:creator" content="@">

      
        <meta name="twitter:title" content="Tự học Tensorflow [P3] - Dataset, Layer">
      
      <meta content="Nguyễn Trần Thức" property="og:site_name">
      
        <meta name="twitter:url" content="https://tranthuc99.github.io/2019/03/11/tu-hoc-tensorflow-p3">
      

      
        <meta name="twitter:description" content="tu hoc tensorflow, tensorflow layer">
      

      

    <link rel="stylesheet" href="/assets/css/main.css" />
    <!-- <link rel="stylesheet" href="/assets/css/custom-style.css" /> -->
    <link rel="stylesheet" href="/assets/bower_components/lightgallery/dist/css/lightgallery.min.css"/>
    <link rel="stylesheet" href="/assets/bower_components/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="/assets/bower_components/font-awesome/web-fonts-with-css/css/fontawesome-all.min.css" />
    <link ref="shortcut icon" href="/assets/img/rp2_Qec_icon.ico" />  
    <!-- UNUSED FOR NOW -->
    <!--<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch.min.css">-->
    <!--<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch-theme-algolia.min.css">-->
    <!--<link rel="stylesheet" href="https://cdn.snipcart.com/themes/v3.0.0-beta.3/default/snipcart.css" />-->
    <!--<link rel="stylesheet" href="/assets/bower_components/icono/dist/icono.min.css"/>-->

    <!-- Fonts-->
    <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

    <!-- Favicon -->
    <link rel="icon" href="https://tranthuc99.github.io/assets/img/rp2_Qec_icon.ico" type="image/gif" sizes="16x16">

    <!-- Jquery -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha384-vk5WoKIaW/vJyUAd9n/wmopsmNhiy+L2Z+SBxGYnUkunIxVxAv/UtMOhba/xskxh" crossorigin="anonymous"></script>

   <!-- <script src="/assets/bower_components/jquery/dist/jquery.min.js"></script> -->
    <script src="/assets/bower_components/jquery.easing/jquery.easing.min.js"></script>
    <script src="/assets/bower_components/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/assets/bower_components/jquery-mousewheel/jquery.mousewheel.min.js"></script>
    <script src="/assets/bower_components/lightgallery/dist/js/lightgallery-all.min.js"></script>
    <script src="/assets/bower_components/imagesloaded/imagesloaded.pkgd.min.js"></script>
    <script src="/assets/bower_components/nanobar/nanobar.min.js"></script>
    <script src="/assets/bower_components/typewrite/dist/typewrite.min.js"></script>
    <!-- UNUSED FOR NOW -->
    <!--<script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch.min.js"></script>-->
    <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.min.js"></script>-->
    <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/picturefill/3.0.2/picturefill.min.js"></script>-->

   <!-- Github Button -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <!-- UNUSED FOR NOW -->
    <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
      integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
      crossorigin="anonymous"></script>
    -->
    <!-- Admin -->
    <meta  property="fb:app_id" content = "2609590356023533" />
    <!-- <meta  property="fb:admins"  content="https://www.facebook.com/tranthuc140820"/> -->
    <meta  property="og:url"  content="nguyentranthuc.tk"  />
    <meta  property="og:title"  content="Thức <3 Hoài"  />
    <meta  property="og:description"  content="abc"  />
    <meta  property="og:image"  content="IMG"  />

    <!-- MathJax -->
  <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>

<!--
  <script>
      (function (d, h, m) {
        var js, fjs = d.getElementsByTagName(h)[0];
        if (d.getElementById(m)) { return; }
        js = d.createElement(h); js.id = m;
        js.onload = function () {
          window.makerWidgetComInit({
            position: "left",
            widget: "ofeeof264otl2l5g-zspk40eq2gaomj2n-higi2qphmveubksi"
          })
        };
        js.src = "https://makerwidget.com/js/embed.js";
        fjs.parentNode.insertBefore(js, fjs)
      }(document, "script", "dhm"))
    </script>
  -->
      <!-- buy me a coffeee -->
    <!--<script data-name="BMC-Widget" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="raquelfishes" data-description="Support me on Buy me a coffee!" data-message="" data-color="#FF813F" data-position="right" data-x_margin="10" data-y_margin="10"></script>

    

    <script>
        (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
          (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date(); a = s.createElement(o),
          m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
        })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

      ga('create', 'UA-166953347-1', 'auto');
      ga('send', 'pageview');
    </script>

  -->

  </head>
<body>       <nav class="navbar navbar-expand-lg fixed-top navbar-dark" id="topNav">
        <button
        class="navbar-toggler"
        type="button"
        data-toggle="collapse"
        data-target="#navbarNav"
        aria-controls="navbarNav"
        aria-expanded="false"
        aria-label="Toggle navigation"
        >
        <span class="icono-hamburger" id="navbar-hamburger"> </span>
      </button>
      <a class="navbar-brand" href="/">
        <img class="navbar-brand-img" src="/assets/img/sign.webp"><!--Nguyễn Trần Thức-->
      </a>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav">
          
          <li class="nav-item">
            <a
            class="nav-link"
            href="https://tranthuc99.github.io/about"
            >About me</a
            >
          </li>
          
          <li class="nav-item">
            <a
            class="nav-link"
            href="https://tranthuc99.github.io/contact"
            >Contact Me</a
            >
          </li>
          
        </ul>
      </div>
      <ul class="nav justify-content-end">

            <!--
            <li class="nav-item">
              <a
                class="nav-link"
                id="search-icon"
                href="https://tranthuc99.github.io/search#/"
                ><i class="fa fa-search" aria-hidden="true"></i
              ></a>
            </li>
            <li class="nav-item" style="margin-top:5px; padding-right:20px;" >
                <a class="header__checkout snipcart-checkout">
                    <svg width="31" height="27" viewBox="0 0 31 27" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path
                        d="M1.10512 0.368718C0.560256 0.368718 0.118164 0.812066 0.118164 1.35848C0.118164 1.9049 0.560256 2.34824 1.10512 2.34824H4.90887L8.30138 18.4009C8.43503 19.0053 8.83085 19.5079 9.32946 19.5041H25.7788C26.3005 19.5118 26.7799 19.0375 26.7799 18.5143C26.7799 17.9911 26.3006 17.5168 25.7788 17.5245H10.1315L9.71003 15.545H27.095C27.5371 15.5412 27.9547 15.2048 28.0511 14.7718L30.354 4.87412C30.4825 4.29933 29.9852 3.67172 29.3979 3.66786H7.21171L6.6771 1.15221C6.58329 0.71276 6.15921 0.368652 5.7107 0.368652L1.10512 0.368718ZM7.623 5.64746H12.7634L13.2569 8.61674H8.25005L7.623 5.64746ZM14.7785 5.64746H20.9881L20.4946 8.61674H15.2719L14.7785 5.64746ZM23.0031 5.64746H28.1537L27.4649 8.61674H22.5097L23.0031 5.64746ZM8.67181 10.5963H13.5862L14.0797 13.5656H9.29919L8.67181 10.5963ZM15.6009 10.5963H20.1656L19.6721 13.5656H16.0944L15.6009 10.5963ZM22.1807 10.5963H27.0023L26.3135 13.5656H21.6872L22.1807 10.5963ZM12.6197 20.164C10.8141 20.164 9.32979 21.6525 9.32979 23.4632C9.32979 25.2739 10.8141 26.7624 12.6197 26.7624C14.4252 26.7624 15.9095 25.2739 15.9095 23.4632C15.9095 21.6525 14.4252 20.164 12.6197 20.164ZM22.4892 20.164C20.6837 20.164 19.1994 21.6525 19.1994 23.4632C19.1994 25.2739 20.6837 26.7624 22.4892 26.7624C24.2948 26.7624 25.7791 25.2739 25.7791 23.4632C25.7791 21.6525 24.2948 20.164 22.4892 20.164ZM12.6197 22.1435C13.3586 22.1435 13.9356 22.7222 13.9356 23.4632C13.9356 24.2042 13.3586 24.7829 12.6197 24.7829C11.8807 24.7829 11.3037 24.2042 11.3037 23.4632C11.3037 22.7222 11.8807 22.1435 12.6197 22.1435ZM22.4892 22.1435C23.2282 22.1435 23.8052 22.7222 23.8052 23.4632C23.8052 24.2042 23.2282 24.7829 22.4892 24.7829C21.7503 24.7829 21.1733 24.2042 21.1733 23.4632C21.1733 22.7222 21.7503 22.1435 22.4892 22.1435Z"
                        fill="#ff7901" class="header__checkout-fill"></path>
                    </svg>
                    <span class="snipcart-items-count"></span>
                    <!-- <span class="snipcart-total-price"></span> 
                  </a>
            </li>
          -->

      <!-- Nhạc tết 
      <audio autoplay="true" preload="auto">
        <source src="assets/vid/Tet-Dong-Day.mp3" type="audio/mpeg">
        </audio>-->

        <li class="nav-item">
          <input
          class="nav-link switch"
          id="theme-toggle"
          onclick="modeSwitcher() "
          type="checkbox"
          name="checkbox"
          />
        </li>
      </ul>
    </nav>
<div class="col-lg-12">
            <div class="row" id="blog-post-container">
  <div class="col-lg-8 offset-md-2"><article class="card" itemscope itemtype="http://schema.org/BlogPosting">
  <div class="card-header">
    <h1 class="post-title" itemprop="name headline">Tự học Tensorflow [P3] - Dataset, Layer</h1>
    <h4 class="post-meta"></h4>
    <p class="post-summary">
      Posted by :  at
      <time datetime="2019-03-11 03:56:20 +0000" itemprop="datePublished"
        >Mar 11, 2019</time
      >
    </p>
    <span
      class="disqus-comment-count"
      data-disqus-identifier="/2019/03/11/tu-hoc-tensorflow-p3"
    ></span>
    <div class="post-categories">
       Category : 
      <a href="/blog/categories/Tensorflow"
        >Tensorflow</a
      >
       
    </div>
  </div>

  <div class="card-body" itemprop="articleBody">
    <img
      class="card-img-top"
      src="https://tranthuc99.github.io/assets/img/posts/"
      alt=""
    />
    <br />
    <br />
    <p>Ở phần trước <a href="https://tranthuc99.github.io/2019/02/26/tu-hoc-tensorflow-p2">Tự học Tensorflow [P2] - Session, Feeding</a>, mình đã nhắc tới 2 thành phần cơ bản của <strong>Tensorflow</strong> đó là <strong><code class="highlighter-rouge">tf.Session</code></strong> và <strong><code class="highlighter-rouge">Feeding</code></strong>. Trong phạm vi bài viết này, mình xin đề cập tới 2 nội dung quan trọng khi training một models với Tensorflow. Nếu chưa theo dõi nhưng phần trước thì bạn có thể tham khảo thêm:</p>
<ul id="markdown-toc">
  <li><a href="#dataset" id="markdown-toc-dataset">Dataset</a></li>
  <li><a href="#layers" id="markdown-toc-layers">Layers</a>    <ul>
      <li><a href="#khởi-tạo-layer" id="markdown-toc-khởi-tạo-layer">Khởi tạo layer</a></li>
      <li><a href="#thực-thi-layer" id="markdown-toc-thực-thi-layer">Thực thi Layer</a></li>
      <li><a href="#lối-tắt-của-phương-thức-layer" id="markdown-toc-lối-tắt-của-phương-thức-layer">Lối tắt của phương thức Layer</a></li>
    </ul>
  </li>
</ul>

<h2 id="dataset">Dataset</h2>
<p>Ở bài trước, chúng ta đã biết <strong><code class="highlighter-rouge">tf.placeholder</code></strong> hoạt động giống như một parameter đầu vào của một phương thức. Vậy khi muốn nạp dữ liệu vào theo một luồng dữ liệu thì thứ chúng ta cần là gì? Câu trả lời chính là <strong><code class="highlighter-rouge">tf.data</code></strong>, nó cung cấp một phương thức cho phép truyền một dòng dữ liệu vào trong model.</p>

<p align="center"><img src="/assets/img/2019-03-11-tu-hoc-tensorflow-p3/dataset.png" /></p>
<p>Để chuyển dữ liệu đầu vào thành một <strong><code class="highlighter-rouge">tf.Tensor</code></strong> chúng ta cần chuyển nó thành dạng <strong><code class="highlighter-rouge">tf.data.Iterator</code></strong> trước tiên. Sau đó sử dụng phương thức <strong><code class="highlighter-rouge">tf.data.Iterator.get_next</code></strong>.
Cách đơn giản nhất để tạo một <code class="highlighter-rouge">Iterator</code> là dùng phương thức <strong><code class="highlighter-rouge">tf.data.Dataset.make_one_shot_iterator</code></strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">my_data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,],</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,],</span>
    <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,],</span>
    <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,],</span>
<span class="p">]</span>
<span class="n">slices</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">Dataset</span><span class="p">.</span><span class="n">from_tensor_slices</span><span class="p">(</span><span class="n">my_data</span><span class="p">)</span>
<span class="n">next_item</span> <span class="o">=</span> <span class="n">slices</span><span class="p">.</span><span class="n">make_one_shot_iterator</span><span class="p">().</span><span class="n">get_next</span><span class="p">()</span>
</code></pre></div></div>

<p>Ở đây, tensor <code class="highlighter-rouge">next_item</code> sẽ trả lại giá trị một dòng từ <code class="highlighter-rouge">my_data</code> mỗi khi được <code class="highlighter-rouge">run</code>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">sess</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">next_item</span><span class="p">))</span>
</code></pre></div></div>
<p><code class="highlighter-rouge">Output</code>:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</code></pre></div></div>

<p>Khi các giá trị của <code class="highlighter-rouge">Iterator</code> được lấy hết, <code class="highlighter-rouge">Dataset</code> sẽ ném ra một exception <strong><code class="highlighter-rouge">tf.errors.OutOfRangeError</code></strong>.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">sess</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">next_item</span><span class="p">))</span>
  <span class="k">except</span> <span class="n">tf</span><span class="p">.</span><span class="n">errors</span><span class="p">.</span><span class="n">OutOfRangeError</span><span class="p">:</span>
    <span class="k">break</span>
</code></pre></div></div>
<p>Nếu <strong><code class="highlighter-rouge">Dataset</code></strong> được xây dựng lên từ một phương thức của Tensor, chúng ta cần khởi tạo Iterator trước khi sử dụng, giống như việc gọi <code class="highlighter-rouge">sess.run</code> để Tensor trả về giá trị vậy. Chúng ta sử dụng <strong><code class="highlighter-rouge">tf.data.Dataset.make_initializable_iterator()</code></strong> để khởi tạo chúng.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">r</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">random_normal</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">Dataset</span><span class="p">.</span><span class="n">from_tensor_slices</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="n">iterator</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">.</span><span class="n">make_initializable_iterator</span><span class="p">()</span>
<span class="n">next_row</span> <span class="o">=</span> <span class="n">iterator</span><span class="p">.</span><span class="n">get_next</span><span class="p">()</span>

<span class="n">sess</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">iterator</span><span class="p">.</span><span class="n">initializer</span><span class="p">)</span>
<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">sess</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">next_row</span><span class="p">))</span>
  <span class="k">except</span> <span class="n">tf</span><span class="p">.</span><span class="n">errors</span><span class="p">.</span><span class="n">OutOfRangeError</span><span class="p">:</span>
    <span class="k">break</span>
</code></pre></div></div>
<h2 id="layers">Layers</h2>
<p>Để training một model, giá trị của các parameter trong Graph cần được xác định bằng cách sử dụng <strong><code class="highlighter-rouge">tf.layers</code></strong>. Các Layer sẽ đóng gói các biến và phương thức hoạt động trên nó. Điển hình có thể nói đến đó là fully-connected layers cùng với hàm kích hoạt. Các kết nối giữa các <code class="highlighter-rouge">weights</code> và <code class="highlighter-rouge">biases</code> được quản lý bởi đối tượng Layer.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">placeholder</span><span class="p">(</span><span class="n">tf</span><span class="p">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">linear_model</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">linear_model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div></div>
<h3 id="khởi-tạo-layer">Khởi tạo layer</h3>
<p>Nếu <code class="highlighter-rouge">Layer</code> chứa biến thì cần phải được khởi tạo trước khi sửa dụng. Mặc dù có thể khởi tạo các biến một cách độc lập, <code class="highlighter-rouge">Tensorflow</code> cung cấp phương thức để có thể dễ dàng khởi tạo tất cả các biến có mặt trong Graph:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">init</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">global_variables_initializer</span><span class="p">()</span>
<span class="n">sess</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">init</span><span class="p">)</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">Chú ý</code>: <strong>global__variables_initializer()</strong> chỉ khởi tạo giá trị cho các biến đã xuất hiện trong Graph khi thực thi khởi tạo. Vậy nên hãy luôn đặt khởi tạo ở cuối cùng của Graph.</p>
<h3 id="thực-thi-layer">Thực thi Layer</h3>
<p>Lúc này Layer đã được khởi tạo, chúng ta có thể bắt đầu khởi chạy một model <code class="highlighter-rouge">Linear</code> đơn giản.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">sess</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]]}))</span>
</code></pre></div></div>
<p><code class="highlighter-rouge">Output</code>:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[[</span><span class="o">-</span><span class="mf">3.41378999</span><span class="p">]</span>
 <span class="p">[</span><span class="o">-</span><span class="mf">9.14999008</span><span class="p">]]</span>
</code></pre></div></div>
<p>Giá trị trả về là weight và bias của Layer <code class="highlighter-rouge">Dense</code> mà chúng ta đã tạo ở trên với số lượng <code class="highlighter-rouge">unint</code> bằng 1 vậy nên chỉ có 1 weight khi thực thi <code class="highlighter-rouge">fully-connected</code>.</p>
<h3 id="lối-tắt-của-phương-thức-layer">Lối tắt của phương thức Layer</h3>
<p>Với mỗi lớp Layer (VD: <strong><code class="highlighter-rouge">tf.layers.Dense</code></strong>), Tensorflow cũng hỗ trợ lối tắt (VD: <strong><code class="highlighter-rouge">tf.layers.dense</code></strong>).
Cách sử dụng:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">placeholder</span><span class="p">(</span><span class="n">tf</span><span class="p">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">linear_model</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">linear_model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div></div>
<p>Chuyển thành:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">placeholder</span><span class="p">(</span><span class="n">tf</span><span class="p">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">dense</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>
<p><code class="highlighter-rouge">Chú ý</code>: Tuy cách sử dụng này khá tiện lợi nhưng vì sử dụng lối tắt nên lúc này bạn không thể can thiệp vào layer <code class="highlighter-rouge">Dense</code> để debug thông qua biến <code class="highlighter-rouge">linear_model</code> như bình thường vì lúc này vai trò của biến <code class="highlighter-rouge">linear_model</code> đã biến mất và thay thế bằng cách gọi trực tiếp hàm <code class="highlighter-rouge">dense</code>.</p>

<p><strong>Bài viết tham khảo và sử dụng hình ảnh từ:</strong></p>
<ul>
  <li><a href="https://www.tensorflow.org/guide/low_level_intro">Low Level APIs from Tensorflow</a></li>
</ul>

  </div><div class="comments">

<div id="fb-root"></div>
<script async defer crossorigin="anonymous" src="https://connect.facebook.net/vi_VN/sdk.js#xfbml=1&version=v7.0" nonce="iXnIUCbx"></script>
</div><!-- Incomment incase you want to use Disqus
      <div id="disqus_thread"></div>
   -->
</article>

<div class="fb-comments" data-href="https://nguyentranthuc.tk/" data-numposts="4" data-width="100%" data-order-by="reverse_time"></div></div>
</div>
<div class="row">
  <div class="col-md-4">
    <div class="card">
      <div class="card-header">About Nguyễn Trần Thức</div>
      <div class="card-body">
        <p class="author_bio">Hi, my name is Thuc</p><!-- Place this tag where you want the github button to render. -->
<!--
<a class="github-button" href="https://github.com/raquelfishes/raquelfishes.github.io" data-color-scheme="no-preference: dark; light: dark; dark: dark;" data-icon="octicon-star" data-size="large" data-show-count="true" aria-label="Star raquelfishes-site on GitHub">Star this Project</a>
-->
</div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card">
      <div class="card-header">Categories</div>
      <div class="card-body text-dark">
             
            <div id="#Ultilities"></div>
            <li class="tag-head">
                <a href="/blog/categories/Ultilities">Ultilities</a>
            </li>
            <a name="Ultilities"></a>

             
            <div id="#Tensorflow"></div>
            <li class="tag-head">
                <a href="/blog/categories/Tensorflow">Tensorflow</a>
            </li>
            <a name="Tensorflow"></a>

             
            <div id="#Architectures and Algorithms"></div>
            <li class="tag-head">
                <a href="/blog/categories/Architectures and Algorithms">Architectures and Algorithms</a>
            </li>
            <a name="Architectures and Algorithms"></a>

             
            <div id="#guides"></div>
            <li class="tag-head">
                <a href="/blog/categories/guides">guides</a>
            </li>
            <a name="guides"></a>

             
            <div id="#tutorials"></div>
            <li class="tag-head">
                <a href="/blog/categories/tutorials">tutorials</a>
            </li>
            <a name="tutorials"></a>

             
            <div id="#jekyll"></div>
            <li class="tag-head">
                <a href="/blog/categories/jekyll">jekyll</a>
            </li>
            <a name="jekyll"></a>

             
            <div id="#Paper Review"></div>
            <li class="tag-head">
                <a href="/blog/categories/Paper Review">Paper Review</a>
            </li>
            <a name="Paper Review"></a>

             
            <div id="#Computer Vision"></div>
            <li class="tag-head">
                <a href="/blog/categories/Computer Vision">Computer Vision</a>
            </li>
            <a name="Computer Vision"></a>

             
            <div id="#Amazon Web Service"></div>
            <li class="tag-head">
                <a href="/blog/categories/Amazon Web Service">Amazon Web Service</a>
            </li>
            <a name="Amazon Web Service"></a>

            </div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card">
      <div class="card-header">Useful Links</div>
      <div class="card-body text-dark">
        
        <li>
          <a href="https://tranthuc99.github.io/about">About me</a>
        </li>
        
        <li>
          <a href="https://tranthuc99.github.io/contact">Contact Me</a>
        </li>
        
      </div>
    </div>
  </div>
</div>

        </div>
        
         <div class="col-lg-12" id="newsletter_footer"><!-- Mailchimp Newletters 
<form action=""method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
<div id="mc_embed_signup_scroll_footer">
    <label for="mce-EMAIL_footer"> Signup for Weekly Email Newsletters :D</label>
    <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL_footer" placeholder="email address" required>
    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups
    <div style="position: absolute; left: -5000px;" aria-hidden="true">
        <input type="text" name="b_50bab1c85eae24ecfb0f68361_3a2dd721d0" tabindex="-1" value="">
    </div><br />
    <div class="clear">
        <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe_footer" class="btn btn-lg btn-success">
    </div>
</div>
-->
</div><footer>
    <p> Powered by<a href="https://github.com/sujaykundu777/devlopr-jekyll"> devlopr jekyll</a>.Hosted at <a href="https://pages.github.com">Github</a>.
        <!--Subscribe via <a href=" /feed.xml ">RSS</a>-->
    </p>
</footer>
<script>
            var options = {
                classname: 'my-class',
                id: 'my-id'
            };
            var nanobar = new Nanobar( options );
            nanobar.go( 30 );
            nanobar.go( 76 );
            nanobar.go(100);
        </script>

<!--
   <div hidden id="snipcart" data-api-key="Y2I1NTAyNWYtMTNkMy00ODg0LWE4NDItNTZhYzUxNzJkZTI5NjM3MDI4NTUzNzYyMjQ4NzU0"></div>
   <script src="https://cdn.snipcart.com/themes/v3.0.0-beta.3/default/snipcart.js" defer></script>
-->
   <script src="/assets/js/mode-switcher.js"></script>


<!-- câu đối năm mới -->
<!--<script type='text/javascript'>

document.write('<div class="tet-2019"><img class="left-2019" id="left-2020" src="https://lh4.googleusercontent.com/-HXBsyeylNsk/XDQOO3VSvjI/AAAAAAAACm0/mN6mv1PCfgc8o3PrRm_kvBWN7KmMjsPqQCLcBGAs/s1600/tet1.png"/><img class="right-2019" id="right-2020" src="https://lh4.googleusercontent.com/-tlsSRiDAay8/XDQOjlNI5uI/AAAAAAAACm8/66f7Unvw1J039PCBEUX9q-gFOfUw8JoGgCLcBGAs/s1600/tet2.png"/></div><style>#left-2020{width: 130px;left:0;z-index:7;position:fixed;;transition:all 0.3s linear;-moz-transition:all 0.3s linear;-webkit-transition:all 0.3s linear}#right-2020{width: 130px;right:0;z-index:7;position:fixed;;transition:all 0.3s linear;-moz-transition:all 0.3s linear;-webkit-transition:all 0.3s linear}.left-2019{top:70px}.right-2019{top:70px}.text-2019-l{top:50px}.text-2019-r{top:50px}@media screen and (max-width:1024px){.tet-2019{display:none}}@media screen and (max-width:1440px){#shareduyblogs{display:none}}</style>')

</script>
<script>
      var lastScroll = 0;
      jQuery(document).ready(function($) {
        $(window).scroll(function() {
          var scroll = $(window).scrollTop();
          if (scroll > lastScroll) {
            $('#right-2020').removeClass('left-2019').addClass('text-2019-l')
            $('#left-2020').removeClass('right-2019').addClass('text-2019-r')
          } else if (scroll < lastScroll) {
            $('#right-2020').addClass('left-2019').removeClass('text-2019-l')
$('#left-2020').addClass('right-2019').removeClass('text-2019-r')
          }
          lastScroll = scroll;
        })
      })
</script>-->


<!-- câu đối năm mới 
<script type='text/javascript'>
document.write('<img style="position:fixed;z-index:0;top:60px;left:0" src="assets/figs/tet-left.png"/><img style="position:fixed;z-index:0;top:60px;right:0" src="assets/figs/tet-right.png"/>');
</script>-->






</body>
</html>
